#ifndef ATMOSUTIL_H_
#define ATMOSUTIL_H_
//provides utilities for creating datasets for equlibrium and spinup run
//and for creating daily drivings

#include <string>
#include <iostream>
#include <fstream>
#include <sstream>
#include <ctime>
#include <cstdlib>
using namespace std;

#undef M_PRECIP //Measured daily precip

#include "../util/Interpolator.h"

#ifdef M_PRECIP

const float prec20055[31] = { 0., 0., 0., 1.01, 0., 0., 0., 0., 0., 0., 0., 0.,
		0., 0., 20.31, 0.25, 7.86, 3.05, 0., 0., 0.25, 1.01, 0., 0., 0., 0.,
		0., 0., 0., 0., 4.55 };
const float prec20056[30] = { 4.05, 1.78, 3.05, 4.06, 4.06, 0., 0., 0., 0.,
		4.82, 0.5, 1.53, 1.52, 2.54, 9.4, 0., 0., 10.41, 19.8, 2.79, 0, 4.57,
		0., 2.54, 2.02, 0.25, 0., 0., 0., 1.53 };
const float prec20057[31] = { 2.53, 0.51, 1.53, 25.91, 0.25, 6.59, 4.57, 6.61,
		1.78, 1.27, 1.01, 3.56, 1.01, 0., 0., 0., 0.25, 34.03, 0., 0., 0., 0.,
		0., 0., 0., 0., 0., 0., 0., 3.03, 0. };
const float
		prec20058[31] = { 0, 0.76, 0.25, 2.03, 0, 1.01, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0.75, 0, 0.25, 1, 0, 0, 0, 0.25, 3.79, 0,
				0.75 };

const double prec20065[31] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.52, 0, 0, 0.51,
		0, 1.77, 0.5, 0, 0, 0, 1.26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
const double prec20066[30] = { 0, 1.77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0,
		0.25, 4.06, 0.76, 0.51, 0, 1.27, 0, 0.5, 0, 0, 7.62, 10.15, 4.82, 0, 0,
		3.8, 0.76 };
const double prec20067[31] = { 6.59, 0.25, 0, 9.65, 2.03, 7.1, 0, 0.25, 0, 0,
		0, 1.01, 6.34, 2.27, 7.11, 0, 0.25, 0, 0, 0, 0.25, 0, 0, 1.26, 0, 0, 0,
		0.25, 7.1, 0.25, 0 };
const double prec20068[31] = { 0, 0, 0, 0.25, 0, 3.55, 2.79, 0, 4.81, 2.29,
		11.43, 4.83, 0.75, 1.01, 1, 6.85, 24.38, 5.83, 2.51, 1.51, 0, 0.5, 0,
		5.59, 3.55, 3.04, 0, 0, 0, 0, 3.81 };

const double prec20076[30] = { 0, 0, 0.508, 10.16, 13.208, 0, 0, 0, 4.318,
		4.318, 0, 0, 0.762, 0, 0, 0.254, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.62,
		0.254, 0 };
const double prec20077[31] = { 0, 0, 0.254, 3.302, 1.778, 0.254, 0, 0, 6.096,
		0, 0.508, 20.32, 0.762, 0, 0.508, 0.254, 0, 0, 0, 0.508, 0, 0, 0,
		0.254, 8.89, 4.572, 0.254, 2.54, 9.652, 1.27, 0 };
const double prec20078[31] = { 0, 0, 7.112, 17.526, 16.764, 0.254, 0, 0, 0,
		9.652, 4.318, 3.81, 0, 0, 0, 0, 1.524, 0, 0, 2.286, 0.254, 2.032,
		0.254, 0, 0, 0, 0, 0, 0, 0, 0.254 };
const double prec20079[30] = { 0.254, 0, 0, 1.778, 0, 0.254, 1.016, 0, 0,
		3.048, 0, 0.508, 12.446, 29.718, 0.508, 0.254, 7.366, 0.254, 0.254, 0,
		0, 0, 3.048, 0, 0, 0, 0, 0, 0, 1.778 };

const double prec20085[31] = { 4.572, 0.254, 1.27, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		1.524, 3.302, 1.016, 0, 0, 5.588, 0.762, 0, 0.254, 0.762, 0, 0, 4.318,
		0, 0, 0, 0, 0, 2.032 };
const double prec20086[30] = { 8.89, 0, 0, 0, 0, 6.096, 0, 0, 2.54, 0, 0,
		0.254, 5.334, 0.254, 0, 0.254, 0, 0, 4.064, 8.382, 1.524, 0, 0, 2.54,
		9.652, 0, 1.27, 5.588, 0, 0 };
const double prec20087[31] = { 0, 0, 0, 1.778, 0.762, 12.954, 0, 0, 0, 0,
		0.762, 0, 0, 0.254, 0.508, 0.762, 2.286, 0.254, 0, 2.54, 0.508, 0,
		0.508, 8.128, 12.446, 12.954, 7.874, 24.384, 2.286, 5.842, 0 };
const double prec20088[31] = { 5.588, 2.54, 1.016, 5.842, 7.62, 1.27, 9.144, 0,
		0, 0, 13.972, 1.27, 0.254, 1.778, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, };

const double prec20095[31] = { 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 1, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0.75, 0, 0 };
const double prec20096[30] = { 0, 0, 0, 2.26, 0, 0, 0, 0, 0, 0, 19.3, 0, 0, 0,
		0, 0, 0, 6.34, 6.09, 1, 0, 2, 6, 0, 0, 1.51, 1.5, 0, 0, 0 };
const double prec20097[31] = { 0, 0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 0, 0.25,
		0, 0, 0, 0, 0, 0, 0.25, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
const double prec20098[31] = { 0, 0, 0, 0.75, 8.31, 0, 0.25, 2.27, 0, 0, 0,
		2.75, 0.25, 4.77, 4.03, 0, 1.76, 0.25, 0, 0, 0, 4.04, 0.5, 1.5, 0.5,
		0.5, 2.02, 0, 7.56, 5.04, 0.5 };

const double prec20105[31] = { 0, 0, 0, 2.76, 0, 0, 0, 0, 0, 0, 0, 1.27, 0,
		0.25, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0, 0.25, 0, 0, 0, 0, 0, 3.55 };
const double prec20106[30] = { 0, 4.57, 3.79, 0.5, 0, 0, 3.29, 1.52, 0.51,
		1.27, 3.55, 0.25, 0, 0, 0.25, 0.25, 0, 0, 3.01, 0.25, 0, 0, 0.25, 0.51,
		5.07, 1.27, 0, 4.31, 0.25, 0 };
const double prec20107[31] = { 0, 2.53, 0.25, 4.31, 0, 0, 0, 0, 0.5, 0, 0, 0.5,
		2.53, 1.27, 0, 1.77, 0, 1.5, 1.26, 4.05, 0, 0, 0.25, 0, 4.32, 0, 0.25,
		0, 0, 0, 0 };
const double prec20108[31] = { 0, 0, 0, 0, 3.29, 0.76, 0, 0.25, 0, 1.27, 3.56,
		0.25, 0, 0, 0.25, 1.53, 0.75, 0, 0, 0, 0, 0, 0.25, 0, 0, 2, 13.21, 0,
		0.5, 0, 0 };

const double prec20115[31] = { 2.79, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 1.01, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
const double prec20116[30] = { 0.75, 0.25, 0, 0, 0, 0, 0, 2.53, 0, 0, 4.05,
		3.54, 1.77, 0.25, 1.78, 0.76, 0, 0, 1.01, 0, 0.25, 0, 0, 5.58, 0.75,
		0.5, 5.32, 0.76, 1.77, 0 };
const double prec20117[31] = { 1.51, 0.25, 3.28, 0, 0, 0, 5.84, 0, 0, 0, 0, 0,
		0, 0, 6.6, 0, 2.03, 0, 0, 0, 0, 0, 0.25, 0.76, 4.31, 3.54, 0, 1.52,
		2.76, 0.75, 0 };
const double prec20118[31] = { 0.5, 0, 0, 0, 0, 2.27, 0, 2.01, 0, 0.25, 0.25,
		3.54, 0.25, 0, 0, 0.75, 0, 0, 1.26, 10.38, 1.27, 0.25, 0, 0, 0, 0, 0,
		0, 0, 1.27, 1.52 };

#endif

class AtmosUtil {

public:
	AtmosUtil();
	~AtmosUtil();

	void updateDailyDriver(float tad[], const float prevta, const float curta,
			const float nextta, const int & dinmprev, const int & dinmcurr,
			const int & dinmnext);

	void updateDailyPrec(const int yindex, const int mindex, float precd[],
			const int & dinmcurr, const float & mta, const float & mprec,
			const int flag);

private:
	Interpolator itp;
	double RAININTE[32], RAINDUR[32];
};
#endif /*ATMOSUTIL_H_*/
